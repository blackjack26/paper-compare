<link href="../polymer/polymer.html" rel="import">
<link href="../paper-material/paper-material.html" rel="import">

<!--
`paper-compare` is a way to compare two lists and move items from one list to another.

Example:

    <paper-compare left-title="LeftList" right-title="RightList">
        <div role="listbox" class="compare-list" id="left">
            <paper-item>Kevin M</paper-item>
            <paper-item>John G</paper-item>
        </div>
        <div role="listbox" class="compare-list" id="right">
            <paper-item>Alicia H</paper-item>
            <paper-item>Samantha K</paper-item>
            <paper-item>Melissa M</paper-item>
        </div>
    </paper-compare>

The `elevation` of the element can be raised by setting the elevation attribute. This elevation corresponds to the Material paper design for elevation.

    <paper-compare elevation="2">
        ...
    </paper-compare>

The color of the header can be changed by changing the value for `--paper-header-color`.

    <style is="custom-style">
        paper-compare {
            --paper-header-color: #339966;
        }
    </style>
-->

<dom-module id="paper-compare">
	<style is="custom-style">
		h1 {
			padding: 5px 10px;
			margin: 0;
			font-family: sans-serif;
			border-bottom: 1px solid rgba(0,0,0,0.1);
			text-align: center;
			font-size: 25px;
			color: rgba(255,255,255,0.95);
			background: var(--paper-header-color, --paper-cyan-a700);
		}
		.compare {
			display: flex;
		}
		#right-div {
			border-left: 1px solid rgba(0,0,0,0.2);
		}
		#left-div, #right-div {
			flex: auto;
			flex-grow: 1;
    		flex-basis: 0;
		}
        
        :host([hidden]) {
            display: none !important;
        }
	</style>

	<template>
		<paper-material class="compare" elevation="{{elevation}}">
			<div id="left-div">
				<h1>[[leftTitle]]</h1>
				<content id="left-content" select=".compare-list#left"></content>
			</div>

			<div id="right-div">
				<h1>[[rightTitle]]</h1>
				<content id="right-content" select=".compare-list#right"></content>
			</div>
		</paper-material>
	</template>

	<script>
		Polymer({
			is: "paper-compare",

			properties: {
                /**
                 * The title for the left list which is centered above the list.
                 */
				leftTitle: {
					type: String,
                    reflectToAttribute: true
				},
                /**
                 * The title for the right list which is centered above the list.
                 */
				rightTitle: {
					type: String,
                    reflectToAttribute: true
				},
                /**
                 * The z-depth of this element, from 0-5. Setting to 0 will remove the shadow, and each increasing number greater than 0 will be "deeper" than the last.
                 */
				elevation: {
					type: Number,
					value: 1,
                    reflectToAttribute: true
				},
                /**
                 * This is a custom function that is executed every time an element moves from one list to another. By default it does nothing. A proper function would look like "func()".
                 */
				onmove: {
					type: String,
					notify: true
				}
			},
			attached: function() {
				if (this.onmove) {
					this.onMoveFunc = new Function('return ' + this.onmove);
				}
			},

			listeners: {
				'tap': '_onTap'
			},

			_moveLeft: function(e) {
				document.getElementById("left").appendChild(e);
				this.onMoveFunc();
			},

			_moveRight: function(e) {
				document.getElementById("right").appendChild(e);
				this.onMoveFunc();
			},

			_onTap: function(e) {
				if (e.target.parentNode.getAttribute("class").includes("compare-list")) {
					var side = e.target.parentNode.id;
					if (side == "left")
						this._moveRight(e.target);
					else if (side == "right")
						this._moveLeft(e.target);
					else
						throw "Parent does not have either 'left' or 'right' id.";
				}
			}
		});
	</script>
</dom-module>